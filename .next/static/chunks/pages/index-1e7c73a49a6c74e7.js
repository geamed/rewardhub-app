(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2165:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>c});var t=s(7876),n=s(4232),o=s(7723),r=s(4131),l=s(5259);let i=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})})},c=e=>{let{email:a,onGoToLogin:s,onResendVerification:c,addNotification:d}=e,[m,u]=(0,n.useState)(!1),x=async()=>{u(!0);try{await c(a)}catch(e){console.error("EmailVerificationPage: Error during resend click:",e),d("Failed to resend verification email. Please try again.",l._.ERROR)}finally{u(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100 p-4 text-center",children:[(0,t.jsxs)("div",{className:"flex items-center mb-8 text-primary-dark",children:[(0,t.jsx)(r.A,{className:"h-12 w-12 mr-3"}),(0,t.jsx)("h1",{className:"text-4xl font-bold",children:o.C3})]}),(0,t.jsxs)("div",{className:"w-full max-w-lg bg-white p-8 sm:p-10 rounded-xl shadow-2xl",children:[(0,t.jsx)(i,{className:"h-16 w-16 text-primary mx-auto mb-6"}),(0,t.jsx)("h2",{className:"text-2xl sm:text-3xl font-semibold text-slate-800 mb-4",children:"Verify Your Email Address"}),(0,t.jsx)("p",{className:"text-slate-600 mb-3",children:"Thank you for signing up! A verification link has been sent to:"}),(0,t.jsx)("p",{className:"text-lg font-medium text-primary-dark mb-6 break-all",children:a}),(0,t.jsx)("p",{className:"text-slate-600 mb-6",children:"Please check your inbox (and spam/junk folder) and click on the link to activate your account. Once verified, you can log in."}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:x,disabled:m,className:"w-full bg-secondary hover:bg-amber-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-colors duration-300 flex items-center justify-center disabled:opacity-60",children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:"Resending..."})]}):"Resend Verification Email"}),(0,t.jsx)("button",{onClick:s,className:"w-full border border-primary text-primary hover:bg-primary-light hover:text-white font-semibold py-3 px-4 rounded-lg shadow-sm transition-colors duration-300",children:"Go to Login Page"})]}),(0,t.jsx)("p",{className:"mt-6 text-xs text-slate-500",children:"If you don't receive the email within a few minutes, please try resending it."})]})]})}},4131:(e,a,s)=>{"use strict";s.d(a,{A:()=>n});var t=s(7876);s(4232);let n=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H7.5a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A3.375 3.375 0 0 0 12 12m0 0a3.375 3.375 0 0 0 0 7.125M12 12a3.375 3.375 0 0 1 0-7.125M12 12v7.125m0-7.125a3.375 3.375 0 0 0 0-7.125M6.375 5.625a3.375 3.375 0 0 1 0 6.75M6.375 12a3.375 3.375 0 0 1 0-6.75M17.625 5.625a3.375 3.375 0 0 1 0 6.75M17.625 12a3.375 3.375 0 0 1 0-6.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})}},5002:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>d});var t=s(7876),n=s(4232),o=s(4918),r=s(7723),l=s(4131),i=s(5259);let c=e=>e?e.message&&e.message.toLowerCase().includes("invalid login credentials")?"Invalid email or password.":e.message&&e.message.includes("User already registered")?"This email address is already in use by another account.":e.message&&e.message.includes("Password should be at least 6 characters")?"Password is too weak. It should be at least 6 characters long.":e.message&&e.message.includes("Unable to validate email address: invalid format")?"Invalid email address format. Please check and try again.":e.message&&e.message.toLowerCase().includes("for expiry duration check if your email provider cancelled block")?"Email rate limit exceeded. Please try again later.":e.message&&e.message.toLowerCase().includes("error sending confirmation mail")?"There was an issue sending the confirmation email. Please try signing up again later.":(console.warn("Unhandled Supabase Auth Error:",e.name,e.message),e.message||"An unexpected authentication error occurred. Please try again later."):"An unexpected error occurred.",d=e=>{let{onAuthSuccess:a,onSuccessfulSignup:s,addNotification:d,initialMode:m="login"}=e,[u,x]=(0,n.useState)("login"===m),[h,p]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),[w,y]=(0,n.useState)(""),[j,b]=(0,n.useState)(null),[v,N]=(0,n.useState)(null),[S,C]=(0,n.useState)(null),{login:k,signup:A,isLoading:R}=(0,o.A)(),[M,L]=(0,n.useState)(!1);n.useEffect(()=>{x("login"===m)},[m]);let P=async e=>{if(e.preventDefault(),L(!0),b(null),N(null),C(null),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)){b("Please enter a valid email address."),L(!1);return}if(0===g.length){N("Password cannot be empty."),L(!1);return}if(!u){if(g.length<6){N("Password must be at least 6 characters long."),L(!1);return}if(g!==w){C("Passwords do not match."),L(!1);return}}try{if(u){let e=await k(h,g);e.error?d(c(e.error),i._.ERROR):(d("Login successful! Welcome back.",i._.SUCCESS),a())}else{let e=await A(h,g);e.error?d(c(e.error),i._.ERROR):(d("Signup successful! Please check your email to verify your account.",i._.SUCCESS),s(h))}}catch(e){console.error("AuthPage: Unexpected error during auth operation",e),d("An unexpected error occurred. Please try again.",i._.ERROR)}finally{L(!1)}},E=R||M;return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center mb-8 text-primary-dark",children:[(0,t.jsx)(l.A,{className:"h-12 w-12 mr-3"}),(0,t.jsx)("h1",{className:"text-4xl font-bold",children:r.C3})]}),(0,t.jsxs)("div",{className:"w-full max-w-md bg-white p-8 rounded-xl shadow-2xl",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-slate-700 mb-6",children:u?"Welcome Back!":"Create Your Account"}),(0,t.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-600",children:"Email Address"}),(0,t.jsx)("input",{type:"email",id:"email",value:h,onChange:e=>{p(e.target.value),b(null)},required:!0,className:"mt-1 w-full px-3 py-2 border ".concat(j?"border-red-500":"border-slate-300"," rounded-md shadow-sm focus:ring-primary focus:border-primary sm:text-sm"),placeholder:"you@example.com","aria-describedby":j?"email-error":void 0,autoComplete:"email"}),j&&(0,t.jsx)("p",{id:"email-error",className:"mt-1 text-xs text-red-500",children:j})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-600",children:"Password"}),(0,t.jsx)("input",{type:"password",id:"password",value:g,onChange:e=>{f(e.target.value),N(null)},required:!0,minLength:u?void 0:6,className:"mt-1 w-full px-3 py-2 border ".concat(v?"border-red-500":"border-slate-300"," rounded-md shadow-sm focus:ring-primary focus:border-primary sm:text-sm"),placeholder:"••••••••","aria-describedby":v?"password-error":void 0,autoComplete:u?"current-password":"new-password"}),v&&(0,t.jsx)("p",{id:"password-error",className:"mt-1 text-xs text-red-500",children:v})]}),!u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-600",children:"Confirm Password"}),(0,t.jsx)("input",{type:"password",id:"confirmPassword",value:w,onChange:e=>{y(e.target.value),C(null)},required:!0,className:"mt-1 w-full px-3 py-2 border ".concat(S?"border-red-500":"border-slate-300"," rounded-md shadow-sm focus:ring-primary focus:border-primary sm:text-sm"),placeholder:"••••••••","aria-describedby":S?"confirm-password-error":void 0,autoComplete:"new-password"}),S&&(0,t.jsx)("p",{id:"confirm-password-error",className:"mt-1 text-xs text-red-500",children:S})]}),(0,t.jsx)("button",{type:"submit",disabled:E,className:"w-full bg-primary hover:bg-primary-dark text-white font-semibold py-2.5 px-4 rounded-lg shadow-md transition-colors duration-300 flex items-center justify-center disabled:opacity-50 mt-2",children:E?(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):u?"Login":"Sign Up"})]}),(0,t.jsxs)("p",{className:"mt-6 text-center text-sm text-slate-500",children:[u?"Don't have an account?":"Already have an account?",(0,t.jsx)("button",{onClick:()=>{E||(x(!u),b(null),N(null),C(null),p(""),f(""),y(""))},className:"font-medium text-primary hover:text-primary-dark ml-1 focus:outline-none disabled:opacity-70",disabled:E,children:u?"Sign Up":"Login"})]})]})]})}},6760:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(8890)}])},8890:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>I});var t=s(7876),n=s(4918),o=s(4232),r=s(7723),l=s(4131);let i=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m-3 0H3m0 0 3.75-3.75M3 12l3.75 3.75"})})},c=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"})})},d=e=>{let{onLogout:a,userEmail:s,isAdmin:n,onNavigateToAdmin:o,onNavigateToDashboard:d,currentView:m}=e;return(0,t.jsx)("header",{className:"bg-primary-dark shadow-md",children:(0,t.jsx)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(l.A,{className:"h-8 w-8 text-white"}),(0,t.jsx)("button",{onClick:d,className:"text-2xl sm:text-3xl font-bold text-white focus:outline-none focus:ring-2 focus:ring-primary-light rounded-md","aria-label":"Go to dashboard",children:r.C3})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[n&&o&&d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:d,title:"Dashboard","aria-label":"Dashboard",className:"text-sm font-medium px-3 py-2 rounded-md transition-colors duration-150 ".concat("dashboard"===m?"bg-primary text-white":"text-primary-light hover:bg-primary hover:text-white"),children:"Dashboard"}),(0,t.jsxs)("button",{onClick:o,title:"Admin Panel","aria-label":"Admin Panel",className:"flex items-center space-x-1.5 text-sm font-medium px-3 py-2 rounded-md transition-colors duration-150 ".concat("admin"===m?"bg-primary text-white":"text-primary-light hover:bg-primary hover:text-white"),children:[(0,t.jsx)(c,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Admin"})]}),(0,t.jsx)("span",{className:"text-slate-500 hidden sm:inline",children:"|"})]}),s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-sm text-primary-light hidden sm:inline",children:s}),(0,t.jsxs)("button",{onClick:()=>{console.log("Header.tsx: Logout button clicked. Type of onLogout:",typeof a),"function"==typeof a?a():(console.error("Header.tsx: onLogout prop is not a function!",a),alert("Logout action is currently unavailable. Please contact support. (Error: CB_NF)"))},title:"Logout","aria-label":"Logout",className:"flex items-center space-x-2 text-white hover:text-primary-light focus:outline-none focus:ring-2 focus:ring-primary-light rounded-md p-2 transition-colors duration-150",children:[(0,t.jsx)(i,{className:"h-6 w-6"}),(0,t.jsx)("span",{className:"hidden sm:inline text-sm font-medium",children:"Logout"})]})]}):(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)("span",{className:"text-white text-sm",children:"Please log in or sign up"})})]})]})})})},m=()=>(0,t.jsx)("footer",{className:"bg-slate-200 text-slate-600 py-6 text-center mt-12",children:(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," ",r.C3,". All rights reserved."]}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Points for PayPal - Simple & Rewarding"})]})}),u=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})},x=e=>{let{points:a}=e,s=(a/r.T9).toFixed(2);return(0,t.jsxs)("div",{className:"bg-white shadow-lg rounded-xl p-6 transform hover:scale-105 transition-transform duration-300",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-700",children:"Your Balance"}),(0,t.jsx)(u,{className:"h-8 w-8 text-primary"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-5xl font-bold text-primary-dark",children:a.toLocaleString()}),(0,t.jsx)("p",{className:"text-slate-500",children:"Points"})]}),(0,t.jsx)("div",{className:"mt-4 text-center",children:(0,t.jsxs)("p",{className:"text-lg text-slate-600",children:["Equivalent to: ",(0,t.jsxs)("span",{className:"font-semibold text-accent",children:["$",s," USD"]})]})})]})},h=e=>{let{className:a}=e;return(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L1.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09l2.846.813-.813 2.846a4.5 4.5 0 0 0-3.09 3.09ZM18.25 12h.008v.008h-.008V12Zm0 0h.008v.008h-.008V12Zm0 0h.008v.008h-.008V12Zm0-3.75h.008v.008h-.008v-.008Zm0 7.5h.008v.008h-.008v-.008ZM12.75 18.25h.008v.008h-.008v-.008Z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v18m6-12H6"})]})},p=e=>{let{onEarnPoints:a,isLoading:s,profile:n}=e,o=!!n.country_code&&!!n.postal_code;return(0,t.jsxs)("div",{className:"bg-white shadow-lg rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-700",children:"Earn Points"}),(0,t.jsx)(h,{className:"h-8 w-8 text-secondary"})]}),(0,t.jsxs)("p",{className:"text-slate-600 mb-6",children:["Complete surveys and offers through our partner ",(0,t.jsx)("span",{className:"font-semibold text-primary",children:"TheoremReach"})," to earn points."]}),!o&&(0,t.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4 rounded-r-lg",children:(0,t.jsxs)("p",{className:"text-sm text-yellow-700",children:["Please complete your ",(0,t.jsx)("span",{className:"font-bold",children:"Profile Settings"})," to unlock and access surveys."]})}),(0,t.jsx)("button",{onClick:a,disabled:s||!o,className:"w-full bg-secondary hover:bg-amber-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-colors duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed","aria-live":"polite",children:s&&o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:"Initializing Surveys..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Access TheoremReach Surveys"})]})})]})},g=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})})},f=e=>{let{currentPoints:a,onWithdraw:s,isLoading:n}=e,[l,i]=(0,o.useState)(""),[c,d]=(0,o.useState)(r.f0.toString()),[m,u]=(0,o.useState)(null),[x,h]=(0,o.useState)(null),p=parseInt(c,10),f=isNaN(p)||p<0?0:p/r.T9;return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u(null),h(null);let t=!0;/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)||(u("Please enter a valid PayPal email address."),t=!1);let n=parseInt(c,10);isNaN(n)||n<=0?(h("Please enter a valid number of points."),t=!1):n<r.f0?(h("Minimum withdrawal is ".concat(r.f0.toLocaleString()," points ($").concat((r.f0/r.T9).toFixed(2),").")),t=!1):n>a&&(h("You do not have enough points for this withdrawal."),t=!1),t&&!isNaN(n)&&(s(l,n),i(""))},className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"paypalEmail",className:"block text-sm font-medium text-slate-700 mb-1",children:"PayPal Email Address"}),(0,t.jsx)("input",{type:"email",id:"paypalEmail",value:l,onChange:e=>{i(e.target.value),u(null)},required:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-primary focus:border-primary sm:text-sm",placeholder:"your.paypal@example.com"}),m&&(0,t.jsx)("p",{className:"mt-1 text-xs text-red-500",children:m})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"pointsToWithdraw",className:"block text-sm font-medium text-slate-700 mb-1",children:"Points to Withdraw"}),(0,t.jsx)("input",{type:"number",id:"pointsToWithdraw",value:c,onChange:e=>{d(e.target.value),h(null)},required:!0,min:r.f0,max:a,step:"1",className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-primary focus:border-primary sm:text-sm"}),x&&(0,t.jsx)("p",{className:"mt-1 text-xs text-red-500",children:x}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["Minimum: ",r.f0.toLocaleString()," points. Max: ",a.toLocaleString()," points."]}),f>0&&(0,t.jsxs)("p",{className:"mt-1 text-sm text-slate-600 font-medium",children:["Withdrawal Amount: $",f.toFixed(2)," USD"]})]}),(0,t.jsx)("button",{type:"submit",disabled:n||a<r.f0,className:"w-full bg-primary hover:bg-primary-dark text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-colors duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:"Processing..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Request Withdrawal"})]})}),a<r.f0&&(0,t.jsxs)("p",{className:"text-sm text-red-600 text-center mt-2",children:["You need at least ",r.f0.toLocaleString()," points to make a withdrawal. Current balance: ",a.toLocaleString()," points."]})]})},w=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})})},y=e=>{let{requests:a}=e;return 0===a.length?(0,t.jsxs)("div",{className:"mt-8 text-center text-slate-500 py-8 bg-slate-50 rounded-lg",children:[(0,t.jsx)(w,{className:"h-12 w-12 mx-auto text-slate-400 mb-3"}),(0,t.jsx)("p",{className:"text-lg",children:"No withdrawal requests yet."}),(0,t.jsx)("p",{className:"text-sm",children:"Your withdrawal history will appear here."})]}):(0,t.jsx)("div",{className:"mt-8 flow-root",children:(0,t.jsx)("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,t.jsx)("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-slate-300",children:[(0,t.jsx)("thead",{className:"bg-slate-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-slate-900 sm:pl-6",children:"Date"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900",children:"PayPal Email"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900",children:"Points"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900",children:"Amount (USD)"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900",children:"Status"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900",children:"Details"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-200 bg-white",children:a.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-slate-900 sm:pl-6",children:new Date(e.created_at).toLocaleDateString()}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-slate-500",children:e.paypal_email}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-slate-500",children:e.points.toLocaleString()}),(0,t.jsxs)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-slate-500",children:["$",e.amount_usd.toFixed(2)]}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-slate-500",children:(0,t.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Pending Review"===e.status?"bg-yellow-100 text-yellow-800":"Processed"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})}),(0,t.jsx)("td",{className:"px-3 py-4 text-sm text-slate-500",children:"Rejected"===e.status&&e.rejection_reason?(0,t.jsx)("span",{title:e.rejection_reason,className:"italic cursor-help",children:e.rejection_reason.length>40?"".concat(e.rejection_reason.substring(0,37),"..."):e.rejection_reason}):(0,t.jsx)("span",{className:"text-slate-400 italic",children:"-"})})]},e.id))})]})})})})})},j=e=>{let{currentPoints:a,withdrawalRequests:s,onWithdraw:n,isWithdrawLoading:o}=e;return(0,t.jsxs)("div",{className:"bg-white shadow-lg rounded-xl p-6 mt-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-700",children:"Withdraw Points"}),(0,t.jsx)(g,{className:"h-8 w-8 text-primary"})]}),(0,t.jsx)(f,{currentPoints:a,onWithdraw:n,isLoading:o}),(0,t.jsxs)("div",{className:"mt-10",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"Withdrawal History"}),(0,t.jsx)(y,{requests:s})]})]})};var b=s(5259);let v=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})})},N=[{code:"",name:"Select a Country..."},{code:"AF",name:"Afghanistan"},{code:"AX",name:"\xc5land Islands"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BQ",name:"Bonaire, Sint Eustatius and Saba"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"CV",name:"Cabo Verde"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CD",name:"Congo, Democratic Republic of the"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czechia"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands (Malvinas)"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard Island and McDonald Islands"},{code:"VA",name:"Holy See"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KP",name:"North Korea"},{code:"KR",name:"South Korea"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestine, State of"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RE",name:"R\xe9union"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"SH",name:"Saint Helena, Ascension and Tristan da Cunha"},{code:"KN",name:"Saint Kitts and Nevis"},{code:"LC",name:"Saint Lucia"},{code:"MF",name:"Saint Martin (French part)"},{code:"PM",name:"Saint Pierre and Miquelon"},{code:"VC",name:"Saint Vincent and the Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten (Dutch part)"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard and Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad and Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks and Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UM",name:"United States Minor Outlying Islands"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"VG",name:"Virgin Islands (British)"},{code:"VI",name:"Virgin Islands (U.S.)"},{code:"WF",name:"Wallis and Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"}],S=e=>{let{profile:a,onSave:s,addNotification:n}=e,[r,l]=(0,o.useState)(a.country_code||""),[i,c]=(0,o.useState)(a.postal_code||""),[d,m]=(0,o.useState)(!1),[u,x]=(0,o.useState)(null);(0,o.useEffect)(()=>{l(a.country_code||""),c(a.postal_code||"")},[a]);let h=async e=>{if(e.preventDefault(),x(null),!r)return void x("Please select your country.");if(!i.trim())return void x("Please enter your postal code.");m(!0);let a=await s(r,i.trim());m(!1),a?n("Profile settings saved successfully!",b._.SUCCESS):(n("Failed to save profile settings. Please try again.",b._.ERROR),x("Could not save settings. Please try again later."))},p=r!==(a.country_code||"")||i!==(a.postal_code||"");return(0,t.jsxs)("div",{className:"bg-white shadow-lg rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-700",children:"Profile Settings"}),(0,t.jsx)(v,{className:"h-8 w-8 text-secondary"})]}),(0,t.jsx)("p",{className:"text-slate-600 mb-6",children:"Providing your location helps us find more relevant surveys for you."}),(0,t.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-slate-700",children:"Country"}),(0,t.jsx)("select",{id:"country",value:r,onChange:e=>l(e.target.value),required:!0,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm rounded-md",children:N.map(e=>(0,t.jsx)("option",{value:e.code,children:e.name},e.code||"select"))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-slate-700",children:"Postal Code / ZIP Code"}),(0,t.jsx)("input",{type:"text",id:"postalCode",value:i,onChange:e=>c(e.target.value),required:!0,className:"mt-1 w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-primary focus:border-primary sm:text-sm",placeholder:"e.g., 90210 or A1A 1A1"})]}),u&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:u}),(0,t.jsx)("button",{type:"submit",disabled:d||!p,className:"w-full bg-accent hover:bg-emerald-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-colors duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:"Saving..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Save Profile"})]})})]})]})},C=e=>{let{profile:a,onEarnPoints:s,isEarningPointsLoading:n,withdrawalRequests:o,onWithdraw:r,isWithdrawLoading:l,onSaveProfile:i,addNotification:c}=e;return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsx)(x,{points:a.points}),(0,t.jsx)(S,{profile:a,onSave:i,addNotification:c})]}),(0,t.jsx)(p,{onEarnPoints:s,isLoading:n,profile:a}),(0,t.jsx)(j,{currentPoints:a.points,withdrawalRequests:o,onWithdraw:r,isWithdrawLoading:l})]})},k=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})},A=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})},R=e=>{let{className:a}=e;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:a||"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})})},M=e=>{let a,{notification:s,onDismiss:n}=e;if(!s)return null;let o="",r="status";switch(s.type){case b._.SUCCESS:o="bg-emerald-500",a=A,r="status";break;case b._.ERROR:o="bg-red-500",a=k,r="alert";break;case b._.INFO:default:o="bg-sky-500",a=R,r="status"}return(0,t.jsxs)("div",{className:"".concat("p-4 rounded-lg shadow-xl text-white flex items-center space-x-3 w-full"," ").concat(o),role:r,children:[a&&(0,t.jsx)(a,{className:"h-6 w-6 flex-shrink-0"}),(0,t.jsx)("span",{className:"flex-grow",children:s.message}),(0,t.jsxs)("button",{onClick:()=>n(s.id),className:"ml-auto -mx-1.5 -my-1.5 bg-transparent text-white hover:text-opacity-75 rounded-lg p-1.5 inline-flex h-8 w-8 items-center justify-center focus:ring-2 focus:ring-white","aria-label":"Dismiss",children:[(0,t.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,t.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})};var L=s(5002),P=s(8881),E=s(2165),T=s(7362),_=s(7841);let B=()=>{let{currentUser:e,currentUserProfile:a,logout:s,isLoading:l,isAdmin:i,addWithdrawalRequestToContext:c,updatePointsInContext:u,updateUserDemographics:x,getAllUsersWithdrawalRequests:h,updateUserWithdrawalRequestStatus:p,resendVerificationEmail:g}=(0,n.A)();console.log("App.tsx Render - currentUser:",null==e?void 0:e.id,"isAdmin:",i,"isAuthLoading:",l,"currentUserProfile exists:",!!a);let[f,w]=(0,o.useState)([]),[y,j]=(0,o.useState)(!1),[v,N]=(0,o.useState)(!1),[S,A]=(0,o.useState)(!1),[R,B]=(0,o.useState)("dashboard"),[I,G]=(0,o.useState)([]),[F,U]=(0,o.useState)(!1),[W,D]=(0,o.useState)(null),[V,H]=(0,o.useState)("login"),O=(0,o.useRef)(e),Z=(0,o.useRef)(null),z=(0,o.useRef)(a);(0,o.useEffect)(()=>{z.current=a},[a]),(0,o.useEffect)(()=>(l&&!e?(Z.current&&clearTimeout(Z.current),Z.current=window.setTimeout(()=>{l&&!e?(console.log("App.tsx: Slow load timer fired for full-screen loader. Setting showSlowLoadOptions to true."),U(!0)):console.log("App.tsx: Slow load timer fired, but full-screen loader condition no longer met.")},3e3)):(Z.current&&(clearTimeout(Z.current),Z.current=null),U(!1)),()=>{Z.current&&clearTimeout(Z.current)}),[l,e]),(0,o.useEffect)(()=>{e&&a&&e.email_confirmed_at&&W&&(console.log("App.tsx: User is fully authenticated and profile loaded, clearing verification message prompt."),D(null))},[e,a,W]),(0,o.useEffect)(()=>{e&&i||B("dashboard")},[e,i]);let K=(0,o.useCallback)((e,a)=>{let s={id:crypto.randomUUID(),message:e,type:a};w(e=>[s,...e.slice(0,4)]);let t=window.setTimeout(()=>{w(e=>e.filter(e=>e.id!==s.id))},5e3);return()=>clearTimeout(t)},[]),q=e=>{w(a=>a.filter(a=>a.id!==e))};(0,o.useEffect)(()=>{!O.current||e||l||W||(console.log("App.tsx: Detected logout (currentUser became null). Showing logout notification."),K("You have been logged out successfully.",b._.SUCCESS)),O.current=e},[e,l,K,W]),(0,o.useEffect)(()=>{if(!(null==e?void 0:e.id)||!e.email_confirmed_at)return void G([]);let a=new AbortController;return(async()=>{console.log("App.tsx: Fetching withdrawal requests for user:",e.id);try{let{data:s,error:t}=await _.N.from("withdrawal_requests").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).abortSignal(a.signal);t?("AbortError"!==t.name&&(console.error("App.tsx: Error fetching user withdrawal requests:",t.message,t),K("Could not load withdrawal history: ".concat(t.message),b._.ERROR)),G([])):(G(s||[]),console.log("App.tsx: User withdrawal requests loaded:",s))}catch(e){console.error("App.tsx: Unexpected error in fetchUserWithdrawals:",e),K("An unexpected error occurred while fetching withdrawal history.",b._.ERROR)}})(),()=>{a.abort()}},[e,K]),(0,o.useEffect)(()=>{var s,t;if(!a||!(null==e?void 0:e.id)||!e.email_confirmed_at){(y||window.TR)&&console.log("App.tsx (TR Effect): User logged out or profile not ready. Clearing TheoremReach."),j(!1),window.TR&&(window.TR=void 0);return}if(void 0===window.TheoremReach){console.warn("App.tsx (TR Effect): TheoremReach SDK script not yet loaded."),j(!1);return}if(!a.country_code||!a.postal_code){console.log("App.tsx (TR Effect): Profile incomplete, skipping TheoremReach initialization."),j(!1);return}let n=e.id;if(y&&(null==(t=window.TR)||null==(s=t.config)?void 0:s.userId)===n)return void console.log("App.tsx (TR Effect): TheoremReach already initialized for current user.");console.log("App.tsx (TR Effect): Preparing to initialize TheoremReach for user ID: ".concat(n,"."));try{let e={};a.country_code&&(e.country_code=a.country_code),a.postal_code&&(e.postal_code=a.postal_code);let s={apiKey:r.nN,userId:n,onReward:e=>{let a=e.earnedThisSession||0,s=z.current;a>0&&s&&u(s.points+a).then(e=>{e&&K("You earned ".concat(a," points!"),b._.SUCCESS)})},onRewardCenterOpened:()=>console.log("App.tsx (TR Event): Opened"),onRewardCenterClosed:()=>console.log("App.tsx (TR Event): Closed"),userAttributes:Object.keys(e).length>0?e:void 0};window.TR=new window.TheoremReach(s),j(!0),console.log("App.tsx (TR Effect): TheoremReach SDK Initialized successfully for user:",n,"with attributes:",e)}catch(e){console.error("App.tsx (TR Effect): Failed to initialize TheoremReach SDK:",e.message||e),K("Could not initialize survey provider: ".concat(e.message||"Unknown error"),b._.ERROR),j(!1)}},[e,a,K,u,y]);let Y=(0,o.useCallback)(()=>{var e;y&&(null==(e=window.TR)?void 0:e.showRewardCenter)?window.TR.showRewardCenter():K("Survey provider is not ready. Please complete your profile or wait.",b._.INFO)},[y,K]),J=(0,o.useCallback)(async(s,t)=>{if(!e||!a)return void K("You must be logged in to make a withdrawal.",b._.ERROR);if(t>a.points)return void K("Insufficient points for this withdrawal.",b._.ERROR);N(!0);let{request:n,error:o}=await c({paypal_email:s,points:t,status:"Pending Review",rejection_reason:null});n?(K("Withdrawal request for ".concat(t," points submitted."),b._.SUCCESS),G(e=>[n,...e])):K(null==o?"Withdrawal request failed. Please try again.":o instanceof Error?o.message:(null==o?void 0:o.message)||"Withdrawal request failed. Please try again.",b._.ERROR),N(!1)},[e,a,K,c]),Q=(0,o.useCallback)(async()=>{A(!0)},[]),X=async()=>{A(!1),console.log("App.tsx: User confirmed logout. Proceeding with Supabase logout."),await s(),D(null),H("login"),console.log("App.tsx: logout() in AuthContext completed. Explicitly hiding slow load options and forcing App.tsx re-evaluation.")},$=()=>{console.log("App.tsx: Returning to login page from verification page."),D(null),H("login")},ee=async e=>{console.log("App.tsx: Attempting to resend verification for",e);let{error:a}=await g(e);a?K("Error resending verification: ".concat(a.message),b._.ERROR):K("Verification email resent to ".concat(e,". Please check your inbox (and spam folder)."),b._.SUCCESS)},ea=()=>(0,t.jsx)("div",{className:"fixed top-5 right-5 space-y-3 z-50 w-full max-w-sm","aria-live":"polite","aria-atomic":"true",children:f.map(e=>(0,t.jsx)(M,{notification:e,onDismiss:q},e.id))}),es=(e||l&&!e&&F)&&!W;return(0,t.jsxs)(t.Fragment,{children:[l&&!e?(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("svg",{className:"animate-spin h-10 w-10 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("p",{className:"ml-3 text-slate-600",children:"Loading user session..."})]}),F&&(0,t.jsxs)("div",{className:"mt-6 text-center",children:[(0,t.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:"Taking longer than usual to load..."}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-5 py-2.5 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-primary-light focus:ring-offset-2 w-full sm:w-auto","aria-label":"Refresh the page",children:"Refresh Page"}),(0,t.jsx)("button",{onClick:Q,className:"px-5 py-2.5 border border-primary text-primary font-semibold rounded-lg hover:bg-primary-light hover:text-white transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-primary-light focus:ring-offset-2 w-full sm:w-auto","aria-label":"Logout from your account",children:"Logout"})]})]})]}):!W||e&&e.email_confirmed_at&&a?e?e.email_confirmed_at?l&&!a?(0,t.jsxs)("div",{className:"flex flex-col min-h-screen bg-slate-100 text-slate-800 font-sans",children:[(0,t.jsx)(d,{onLogout:Q,userEmail:e.email,isAdmin:i,onNavigateToAdmin:()=>B("admin"),onNavigateToDashboard:()=>B("dashboard"),currentView:R}),(0,t.jsxs)("main",{className:"flex-grow container mx-auto px-4 py-6 sm:px-6 sm:py-8 lg:px-8 lg:py-10 flex flex-col items-center justify-center",children:[(0,t.jsxs)("svg",{className:"animate-spin h-10 w-10 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("p",{className:"mt-3 text-slate-600",children:"Loading your data..."})]}),(0,t.jsx)(ea,{}),(0,t.jsx)(m,{})]}):a?(0,t.jsxs)("div",{className:"flex flex-col min-h-screen bg-slate-100 text-slate-800 font-sans",children:[(0,t.jsx)(d,{onLogout:Q,userEmail:e.email,isAdmin:i,onNavigateToAdmin:()=>B("admin"),onNavigateToDashboard:()=>B("dashboard"),currentView:R}),(0,t.jsx)("main",{className:"flex-grow container mx-auto px-4 py-6 sm:px-6 sm:py-8 lg:px-8 lg:py-10",children:"admin"===R&&i?(0,t.jsx)(P.default,{getAllRequests:h,updateRequestStatus:p,addNotification:K}):(0,t.jsx)(C,{profile:a,onEarnPoints:Y,isEarningPointsLoading:!y&&!!((null==a?void 0:a.country_code)&&(null==a?void 0:a.postal_code)),withdrawalRequests:I,onWithdraw:J,isWithdrawLoading:v,onSaveProfile:x,addNotification:K})}),(0,t.jsx)(ea,{}),(0,t.jsx)(m,{})]}):(console.error("App.tsx: Rendering 'Error Loading User Data' page. currentUser exists and email confirmed, but currentUserProfile is null. This often indicates an RLS issue with the 'profiles' table or a failed profile creation/fetch. Check AuthContext logs."),(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100 p-4 text-center",children:[(0,t.jsx)(k,{className:"h-16 w-16 text-red-500 mx-auto mb-6"}),(0,t.jsx)("h2",{className:"text-3xl font-semibold text-slate-800 mb-3",children:"Error Loading User Data"}),(0,t.jsx)("p",{className:"text-slate-600 mb-8 max-w-md",children:"We encountered an issue loading your profile. This can happen if your email is verified but the profile setup failed. Please try refreshing or logging out and back in."}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-primary-light focus:ring-offset-2 w-full sm:w-auto",children:"Refresh Page"}),(0,t.jsx)("button",{onClick:Q,className:"px-6 py-3 border border-primary text-primary font-semibold rounded-lg hover:bg-primary-light hover:text-white transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-primary-light focus:ring-offset-2 w-full sm:w-auto",children:"Logout"})]}),(0,t.jsx)("p",{className:"mt-8 text-sm text-slate-500",children:"If the problem persists, please check the browser console for error details from `AuthContext` and contact support."}),(0,t.jsx)(ea,{})," "]})):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.default,{email:e.email||"your email",onGoToLogin:$,onResendVerification:ee,addNotification:K}),(0,t.jsx)(ea,{})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.default,{onAuthSuccess:()=>{console.log("App.tsx: AuthPage reported a successful LOGIN event."),D(null),B("dashboard"),H("login")},onSuccessfulSignup:e=>{console.log("App.tsx: AuthPage reported a successful SIGNUP event for email:",e),D(e),H("login")},addNotification:K,initialMode:V}),(0,t.jsx)(ea,{})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.default,{email:W,onGoToLogin:$,onResendVerification:ee,addNotification:K}),(0,t.jsx)(ea,{})]}),es&&(0,t.jsx)(T.A,{isOpen:S,onClose:()=>{A(!1)},onConfirm:X,title:"Confirm Logout",confirmText:"Logout",confirmButtonClass:"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:(0,t.jsx)("p",{children:"Are you sure you want to log out of your account?"})})]})};function I(){return(0,t.jsx)(n.O,{children:(0,t.jsx)(B,{})})}}},e=>{e.O(0,[881,636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);