"use strict";exports.id=722,exports.ids=[722],exports.modules={3722:(a,b,c)=>{c.r(b),c.d(b,{default:()=>h});var d=c(8732),e=c(2015),f=c(7830),g=c(4245);let h=({getAllRequests:a,updateRequestStatus:b,addNotification:c})=>{let[h,i]=(0,e.useState)([]),[j,k]=(0,e.useState)(!0),[l,m]=(0,e.useState)("Pending Review"),[n,o]=(0,e.useState)(null),[p,q]=(0,e.useState)(!1),[r,s]=(0,e.useState)(null),[t,u]=(0,e.useState)(""),[v,w]=(0,e.useState)(null),x=(0,e.useCallback)(async()=>{k(!0);try{let b=await a();i(b)}catch(a){console.error("AdminPage: Error fetching withdrawal requests:",a),c("Failed to load withdrawal requests.",f._.ERROR),i([])}finally{k(!1)}},[a,c]);(0,e.useEffect)(()=>{x()},[x]);let y=()=>{q(!1),s(null),u(""),w(null)},z=async()=>{if(!r)return;if(!t.trim())return void w("Rejection reason cannot be empty.");w(null),o(r.id);let a=r.points;await b(r.userId,r.id,"Rejected",t)?(c(`Request ${r.id.substring(0,8)}... rejected. ${"Rejected"!==r.status?`${a} points refunded.`:"Reason updated."}`,f._.SUCCESS),i(a=>a.map(a=>a.id===r.id&&a.userId===r.userId?{...a,status:"Rejected",rejection_reason:t}:a))):c(`Failed to reject request ${r.id.substring(0,8)}...`,f._.ERROR),o(null),y()},A=async(a,d)=>{o(d),await b(a,d,"Processed")?(c(`Request ${d.substring(0,8)}... status updated to Processed.`,f._.SUCCESS),i(b=>b.map(b=>b.id===d&&b.userId===a?{...b,status:"Processed",rejection_reason:null}:b))):c(`Failed to approve request ${d.substring(0,8)}...`,f._.ERROR),o(null)},B=h.filter(a=>"all"===l||a.status===l);return(0,d.jsxs)("div",{className:"container mx-auto p-4",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Admin Withdrawal Requests"}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{htmlFor:"statusFilter",className:"mr-2",children:"Filter by Status:"}),(0,d.jsxs)("select",{id:"statusFilter",value:l,onChange:a=>m(a.target.value),className:"border rounded p-1",children:[(0,d.jsx)("option",{value:"all",children:"All"}),(0,d.jsx)("option",{value:"Pending Review",children:"Pending Review"}),(0,d.jsx)("option",{value:"Processed",children:"Processed"}),(0,d.jsx)("option",{value:"Rejected",children:"Rejected"})]})]}),j&&(0,d.jsx)("p",{children:"Loading requests..."}),!j&&0===B.length&&(0,d.jsx)("p",{children:"No withdrawal requests found for the selected filter."}),!j&&B.length>0&&(0,d.jsxs)("table",{className:"min-w-full bg-white",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"Request ID"}),(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"User ID"}),(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"User Email"})," ",(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"Amount (USD)"})," ",(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"Points"}),(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"Status"}),(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"Reason (if rejected)"}),(0,d.jsx)("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),(0,d.jsx)("tbody",{children:B.map(a=>(0,d.jsxs)("tr",{children:[" ",(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:a.id}),(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:a.userId}),(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:a.userEmail})," ",(0,d.jsxs)("td",{className:"py-2 px-4 border-b",children:["$",a.amount_usd?.toFixed(2)]})," ",(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:a.points}),(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:a.status}),(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:a.rejection_reason}),(0,d.jsx)("td",{className:"py-2 px-4 border-b",children:"Pending Review"===a.status&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>A(a.userId,a.id),disabled:n===a.id,className:"bg-green-500 text-white px-2 py-1 rounded mr-2 disabled:opacity-50",children:n===a.id?"Processing...":"Approve"}),(0,d.jsx)("button",{onClick:()=>(a=>{s(a),u(a.rejection_reason||""),w(null),q(!0)})(a),disabled:n===a.id,className:"bg-red-500 text-white px-2 py-1 rounded disabled:opacity-50",children:"Reject"})]})})]},a.id))})]}),(0,d.jsx)(g.A,{isOpen:p,onClose:y,onConfirm:z,title:"Reject Withdrawal Request",confirmText:"Confirm Rejection",confirmButtonClass:"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:r&&(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{className:"mb-4",children:["Rejecting request ID: ",r.id]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{htmlFor:"rejectionReason",className:"block mb-2",children:"Reason for Rejection:"}),(0,d.jsx)("textarea",{id:"rejectionReason",rows:4,className:`w-full border rounded p-2 ${v?"border-red-500":""}`,value:t,onChange:a=>u(a.target.value)}),v&&(0,d.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v})]}),(0,d.jsxs)("div",{className:"flex justify-end",children:[(0,d.jsx)("button",{onClick:y,className:"bg-gray-300 text-gray-800 px-4 py-2 rounded mr-2",children:"Cancel"}),(0,d.jsx)("button",{onClick:z,disabled:!t.trim()||n===r.id,className:"bg-red-500 text-white px-4 py-2 rounded disabled:opacity-50",children:n===r.id?"Submitting...":"Confirm Rejection"})]})]})})]})}},4245:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732),e=c(2015);let f=({isOpen:a,onClose:b,onConfirm:c,title:f,children:g,confirmText:h="Confirm",cancelText:i="Cancel",confirmButtonClass:j="bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelButtonClass:k="bg-slate-200 hover:bg-slate-300 text-slate-700 focus:ring-slate-400"})=>((0,e.useEffect)(()=>{let c=a=>{"Escape"===a.key&&b()};return a&&document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}},[a,b]),a)?(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity duration-300 ease-in-out","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",onClick:b,children:(0,d.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4 transform transition-all duration-300 ease-in-out scale-100",onClick:a=>a.stopPropagation(),children:[(0,d.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,d.jsx)("h3",{id:"modal-title",className:"text-xl font-semibold text-slate-800",children:f}),(0,d.jsx)("button",{type:"button",className:"text-slate-400 bg-transparent hover:bg-slate-200 hover:text-slate-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center",onClick:b,"aria-label":"Close modal",children:(0,d.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,d.jsx)("div",{className:"text-slate-600 mb-6",children:g}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row-reverse sm:justify-start gap-3",children:[(0,d.jsx)("button",{type:"button",onClick:c,className:`w-full sm:w-auto inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${j}`,children:h}),(0,d.jsx)("button",{type:"button",onClick:b,className:`w-full sm:w-auto inline-flex justify-center rounded-md border border-slate-300 shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 sm:mt-0 sm:text-sm ${k}`,children:i})]})]})}):null},7830:(a,b,c)=>{c.d(b,{_:()=>d});var d=function(a){return a.SUCCESS="success",a.ERROR="error",a.INFO="info",a}({})}};